<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        const {log} = console;
        function a(){
            //es6提供了新的数据结构set,它类似于数组，但是成员的值都是唯一的，没有重复的值，
            //set本身是一个构造函数，用来生成Set数据结构
            const a1 = new Set('123');
            log(a1.size);//3
            log(a1);
            for (let value of a1){
                log(value);//1,2,3
            };
            //foreach(function(obj,index){});
            [1,2,3,4,5].forEach((x,y) => log(x));//1,2,3,4,5
            [1,2,3,4,5].forEach((x,y) => log(y));//0,1,2,3,4

            //结果DOM使用
            const a2 = new Set(document.querySelectorAll('div'));
            //可以foreach遍历，of遍历

            //Set可以去重
            const a3 = new Set([1,2,2,3,3,4,5,5]);
            log([...a3]);// [1, 2, 3, 4, 5]

            //去除字符串重复字符
            log([...new Set('122344566')].join(""));//123456
            log([...new Set('abcabc')].join(""));//abc

            //在Set内部，相等用的也是es6规则,Object.is，认为NanN=NaN,但是+0=-0
            let a4 = new Set();
            a4.add(NaN);
            a4.add(NaN);
            log([...a4]);//NaN
            a4.add(+0);
            a4.add(-0);
            log([...a4]);//0

            //记住一句话，两个对象总是不相等的，由于两个空对象不相等，所以它们被视为两个值
            let a5= new Set();
            a5.add({});
            a5.add({});
            log([...a5]);


        };
        //a();

        function b(){
            //Set实例的属性和方法
            //Set结构的实例有以下属性
            //1、Set.prototype.constructor:构造函数，默认就是Set函数
            //2、Set.prototype.size:返回Set实例的成员总数

            //四个方法,Set.prototype.add(),Set.prorotype.delete(),Set.prorotype.has(),Set.prototype.clear()
            //delete,has,返回布尔值
            let a = new Set([1,2,3]);
            a.add(4);
            log(a.has(3));//true
            a.delete(3);
            log(a.has(3));//false
            a.clear();//清除所有成员
            log(a);

        };
        //b();

        function c(){
            //Array.from方法可以将Set结构转为数组
            //这种方式可以去除数组重复项
            const b = new Set([1,2,3,4,5]);
            log(Array.from(b));//[1, 2, 3, 4, 5]


        };
        //c();

        function d(){
            //Set结构的实例有四个遍历方法，可以用于遍历成员
            //Set.prototype.keys() //返回键名的遍历器
            //Set.prototype.values() //返回键值的遍历器
            //Set.prototype.entries() //返回键值对的遍历器
            //Set.prototype.forEach() //使用回调函数遍历每个成员,forEach方法还有第二个参数，表示绑定处理函数内部的this对象
            //由于Set结构没有键名，只有键值（获取说键名和键值是同一个值），所以keys方法
            //和values方法的行为完全一致。
            for (let key of (new Set([1,2])).keys()){
                log(key);//1,2
            };
            for (let value of (new Set([1,2])).values()){
                log(value);
            };
            for (let [key,value] of (new Set([1,2]).entries())){
                log(key,value);
            };
            (new Set([1,2])).forEach((key,value) => {
                log(key,value);
            });

            //可以省略values方法，直接用for...of循环遍历Set
            for (let value of (new Set([1,2]))){
                log(value);//1,2
            };


        };
        //d();

        function e(){
            //遍历的运用
            //拓展运算符...内部使用for...of循环，所以也可以用于Set结构
            let a1 = new Set(['red','green','blue']);
            let a2 = [...a1];
            log(a2);//["red", "green", "blue"]

            //可以去除数组的重复成员
            let a3 = [1,2,3,3,4,4,4,5];
            //Set结构通过拓展运算符重新转成数组
            let a4 = [...(new Set(a3))];
            log(a4);//[1, 2, 3, 4, 5]

            //数组的map和filter方法也可以间接用于Set
            let a5 = new Set([1,2,3]);
            let a6 = new Set([...a5].map(x => x*2));
            log(a6);//{2, 4, 6}
            let a7 = new Set([...a5].filter(x => (x%2)===0));
            log(a7);//{2}

        };
        //e();

        function f(){
            //如果想在遍历操作中，同步改变原来的Set结构，目前没有直接的方法，但有两种变通方法
            //一种是利用原Set结构映射一个新的结构，然后赋值给原来的Set结构，另一种是利用Array.from方法
            //方法一：
            let a1 = new Set([1,2,3]);
            a1 = new Set([...a1].map(x => x*2));
            log(a1);//{2, 4, 6}

            let a2 = new Set([1,2,3]);
            a2 = new Set(Array.from(a2,x => x*2));
            log(a2);//{2, 4, 6}



        };
        f();




    </script>
</body>
</html>